/*	
 * jQuery mmenu drag add-on
 * mmenu.frebsite.nl
 *
 * Copyright (c) Fred Heusschen
 */
!function(e){function n(e,n,t){return e<n&&(e=n),e>t&&(e=t),e}function t(t,o,s){var r,p,c,f,d,l=this,u={},h=0,m=!1,g=!1,v=0,w=0;switch(this.opts.offCanvas.position){case"left":case"right":u.events="panleft panright",u.typeLower="x",u.typeUpper="X",g="width";break;case"top":case"bottom":u.events="panup pandown",u.typeLower="y",u.typeUpper="Y",g="height"}switch(this.opts.offCanvas.position){case"right":case"bottom":u.negative=!0,f=function(e){e>=s.$wndw[g]()-t.maxStartPos&&(h=1)};break;default:u.negative=!1,f=function(e){e<=t.maxStartPos&&(h=1)}}switch(this.opts.offCanvas.position){case"left":u.open_dir="right",u.close_dir="left";break;case"right":u.open_dir="left",u.close_dir="right";break;case"top":u.open_dir="down",u.close_dir="up";break;case"bottom":u.open_dir="up",u.close_dir="down"}switch(this.opts.offCanvas.zposition){case"front":d=function(){return this.$menu};break;default:d=function(){return e("."+i.slideout)}}var b=this.__valueOrFn(t.node,this.$menu,s.$page);"string"==typeof b&&(b=e(b));var _=new Hammer(b[0],this.opts[a].vendors.hammer);_.on("panstart",function(e){f(e.center[u.typeLower]),s.$slideOutNodes=d(),m=u.open_dir}).on(u.events+" panend",function(e){h>0&&e.preventDefault()}).on(u.events,function(e){if(r=e["delta"+u.typeUpper],u.negative&&(r=-r),r!=v&&(m=r>=v?u.open_dir:u.close_dir),v=r,v>t.threshold&&1==h){if(s.$html.hasClass(i.opened))return;h=2,l._openSetup(),l.trigger("opening"),s.$html.addClass(i.dragging),w=n(s.$wndw[g]()*o[g].perc,o[g].min,o[g].max)}2==h&&(p=n(v,10,w)-("front"==l.opts.offCanvas.zposition?w:0),u.negative&&(p=-p),c="translate"+u.typeUpper+"("+p+"px )",s.$slideOutNodes.css({"-webkit-transform":"-webkit-"+c,transform:c}))}).on("panend",function(e){2==h&&(s.$html.removeClass(i.dragging),s.$slideOutNodes.css("transform",""),l[m==u.open_dir?"_openFinish":"close"]()),h=0})}function o(n,t,o,s){var p=this;n.each(function(){var n=e(this),t=n.data(r.parent);if(t&&(t=t.closest("."+i.panel),t.length)){var o=new Hammer(n[0],p.opts[a].vendors.hammer);o.on("panright",function(e){p.openPanel(t)})}})}var s="mmenu",a="drag";e[s].addons[a]={setup:function(){if(this.opts.offCanvas){var n=this.opts[a],i=this.conf[a];c=e[s].glbl,"boolean"==typeof n&&(n={menu:n,panels:n}),"object"!=typeof n&&(n={}),"boolean"==typeof n.menu&&(n.menu={open:n.menu}),"object"!=typeof n.menu&&(n.menu={}),"boolean"==typeof n.panels&&(n.panels={close:n.panels}),"object"!=typeof n.panels&&(n.panels={}),n=this.opts[a]=e.extend(!0,{},e[s].defaults[a],n),n.menu.open&&t.call(this,n.menu,i.menu,c),n.panels.close&&this.bind("initPanels",function(e){o.call(this,e,n.panels,i.panels,c)})}},add:function(){return"function"!=typeof Hammer||Hammer.VERSION<2?void(e[s].addons[a].setup=function(){}):(i=e[s]._c,r=e[s]._d,p=e[s]._e,void i.add("dragging"))},clickAnchor:function(e,n){}},e[s].defaults[a]={menu:{open:!1,maxStartPos:100,threshold:50},panels:{close:!1},vendors:{hammer:{}}},e[s].configuration[a]={menu:{width:{perc:.8,min:140,max:440},height:{perc:.8,min:140,max:880}},panels:{}};var i,r,p,c}(jQuery);